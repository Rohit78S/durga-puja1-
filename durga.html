<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kolkata Durga Puja Guide 2025</title>
    <link rel="manifest" href="data:application/json,{
        'name': 'Kolkata Durga Puja Guide',
        'short_name': 'Puja Guide',
        'description': 'Complete Durga Puja festival companion',
        'start_url': '/',
        'display': 'standalone',
        'background_color': '#8B0000',
        'theme_color': '#DC143C',
        'icons': [
            {
                'src': 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"%3E%3Ccircle cx=\"256\" cy=\"256\" r=\"256\" fill=\"%23DC143C\"/%3E%3Cpath d=\"M256 128c-70.7 0-128 57.3-128 128s57.3 128 128 128 128-57.3 128-128-57.3-128-128-128z\" fill=\"%23FFD700\"/%3E%3C/svg%3E',
                'sizes': '192x192',
                'type': 'image/svg+xml'
            }
        ]
    }">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet CSS for maps -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    
    <style>
        :root {
            /* Light theme colors */
            --primary-color: #8B0000;
            --secondary-color: #DC143C;
            --accent-color: #ff6b35;
            --accent-secondary: #f7931e;
            --bg-primary: linear-gradient(135deg, #fff8f0, #ffe8d6);
            --bg-secondary: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --border-color: #e0e0e0;
            --shadow: 0 5px 20px rgba(0,0,0,0.1);
            --card-bg: #ffffff;
            
            /* Cultural colors */
            --saffron: #ff9933;
            --vermillion: #e34234;
            --marigold: #ffb347;
            --gold: #ffd700;
        }

        [data-theme="dark"] {
            --primary-color: #ff6b6b;
            --secondary-color: #ff8e8e;
            --accent-color: #ffa726;
            --accent-secondary: #ffcc02;
            --bg-primary: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --border-color: #444444;
            --shadow: 0 5px 20px rgba(0,0,0,0.3);
            --card-bg: #3a3a3a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Noto Sans Bengali', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
            background-image: url("https://i.pinimg.com/736x/fe/72/9e/fe729e96b75f9034e4a1267bd2698962.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }

        /* Preloader Fullscreen Background */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #8B0000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 1s ease, visibility 1s ease;
        }

        /* Text Container */
        .welcome-box {
            text-align: center;
            max-width: 90%;
            padding: 20px;
        }

        /* Title (Main Greeting) */
        .puja-title {
            font-size: 3rem;
            font-weight: bold;
            color: gold;
            text-shadow: 0 0 10px #ff4500, 0 0 20px #ffd700;
            animation: glowTitle 2s infinite alternate;
            font-family: "Noto Sans Bengali", sans-serif;
        }

        /* Subtitle (Blessings) */
        .puja-subtitle {
            margin-top: 15px;
            font-size: 1.3rem;
            line-height: 1.6;
            color: #fff8dc;
            font-family: "Noto Sans Bengali", sans-serif;
            animation: fadeIn 3s ease-in-out;
        }

        /* Animations */
        @keyframes glowTitle {
            from { opacity: 0.7; text-shadow: 0 0 10px #ff6347, 0 0 20px #ffd700; }
            to   { opacity: 1; text-shadow: 0 0 25px #ffa500, 0 0 40px #ffd700; }
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* Hide preloader */
        #preloader.hide {
            opacity: 0;
            visibility: hidden;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 1rem 1rem;
            box-shadow: var(--shadow);
            background-image: url("https://i.pinimg.com/736x/e2/61/20/e26120bee406dfcf7be85d2bd847a47c.jpg");
            background-size: cover;
            line-height: 1.6;
            transition: all 0.3s ease;
            margin-top: -20px;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            margin-top: -10px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .theme-toggle, .lang-toggle, .menu-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover, .lang-toggle:hover, .menu-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .header h1 {
            text-align: center;
            font-size: 2.2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 0.5rem;
            margin-top: -10px;
        }

        .header p {
            text-align: center;
            font-size: 1.1rem;
            opacity: 0.9;
            margin-top: -5px;
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin-top: 1rem;
            overflow: hidden;
        }

        .nav-tab {
            flex: 1;
            padding: 0.8rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .nav-tab.active, .nav-tab:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        /* Side Menu */
        .side-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background: var(--card-bg);
            box-shadow: -5px 0 20px rgba(0,0,0,0.3);
            transition: right 0.3s ease;
            z-index: 1001;
            padding: 2rem;
        }

        .side-menu.open {
            right: 0;
        }

        .side-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .side-menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .menu-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .menu-item:hover {
            background: var(--accent-color);
            color: white;
            transform: translateX(5px);
        }

        /* Weather Widget */
        .weather-widget {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            z-index: 1002;
            min-width: 350px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
        }

        .weather-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-primary);
            z-index: 1003;
        }

        .weather-current {
            text-align: center;
            padding: 1rem;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary));
            border-radius: 15px;
            color: white;
            margin-bottom: 1rem;
        }

        .weather-temp {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .weather-desc {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .weather-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .weather-forecast {
            margin-top: 1rem;
        }

        .forecast-day {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.8rem;
            margin: 0.5rem 0;
            background: var(--bg-secondary);
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .forecast-day:hover {
            background: var(--accent-color);
            color: white;
            transform: translateX(5px);
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Content Sections */
        .content-section {
            display: none;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .content-section.active {
            display: block;
            animation: fadeInContent 0.5s ease;
        }

        @keyframes fadeInContent {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pandal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .pandal-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .pandal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--saffron), var(--vermillion), var(--marigold), var(--gold));
        }

        .pandal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            border-color: var(--accent-color);
        }

        .pandal-card.visited {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, var(--card-bg), rgba(139, 0, 0, 0.05));
        }

        .pandal-card.visited::after {
            content: 'আপনি পৌঁছেছেন';
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary-color);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .crowd-indicator {
            position: absolute;
            top: 15px;
            left: 15px;
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }

        .crowd-low { background: #28a745; }
        .crowd-medium { background: #ffc107; color: #000; }
        .crowd-high { background: #dc3545; }

        .pandal-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .pandal-type {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary));
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-block;
        }

        .pandal-details {
            margin: 1rem 0;
        }

        .detail-item {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }

        .detail-icon {
            width: 20px;
            margin-right: 0.5rem;
            color: var(--accent-color);
        }

        /* Buttons */
        .btn {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary));
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            margin: 0.3rem 0.3rem 0.3rem 0;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255,107,53,0.4);
        }

        .btn.bookmarked {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .btn.reached {
            background: linear-gradient(135deg, #28a745, #20c997);
        }

        /* Search and Filter */
        .search-container {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }

        .search-input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .filter-btn {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
        }

        .filter-btn.active, .filter-btn:hover {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary));
            color: white;
            border-color: var(--accent-color);
        }

        /* Map Styles */
        #map {
            height: 500px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            z-index: 1;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--border-color);
            border-radius: 10px;
            height: 8px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(90deg, var(--accent-color), var(--accent-secondary));
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Route Container */
        .route-container {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 5px solid var(--accent-color);
            box-shadow: var(--shadow);
        }

        /* AR Features */
        .ar-container {
            position: relative;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: var(--shadow);
        }

        #arCamera {
            width: 100%;
            height: 300px;
            border-radius: 10px;
            background: #000;
            position: relative;
            overflow: hidden;
        }

        .ar-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            z-index: 2;
        }

        .ar-pointer {
            position: absolute;
            width: 60px;
            height: 60px;
            background: rgba(255, 107, 53, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Gamification */
        .badge-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }

        .badge {
            background: linear-gradient(135deg, var(--gold), var(--marigold));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 3px 10px rgba(255, 215, 0, 0.3);
        }

        .badge.locked {
            background: var(--border-color);
            color: var(--text-secondary);
        }

        /* Photo Gallery */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .photo-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            aspect-ratio: 1;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .photo-item:hover {
            transform: scale(1.05);
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Food Map */
        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .food-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 1rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .food-card:hover {
            transform: translateY(-3px);
        }

        .food-rating {
            color: var(--gold);
            margin: 0.5rem 0;
        }

        /* Emergency Section */
        .emergency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .emergency-card {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .emergency-card:hover {
            transform: scale(1.05);
        }

        .emergency-number {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(255,107,53,0.4);
            font-size: 24px;
            color: white;
            z-index: 999;
            transition: all 0.3s ease;
            border: none;
        }

        .fab:hover {
            transform: scale(1.1);
        }

        /* SOS Button */
        .sos-button {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #dc3545, #c82333);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(220, 53, 69, 0.4);
            font-size: 18px;
            color: white;
            z-index: 999;
            transition: all 0.3s ease;
            border: none;
            font-weight: bold;
        }

        .sos-button:hover {
            transform: scale(1.1);
            animation: pulseButton 1s infinite;
        }

        @keyframes pulseButton {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }

        /* Bengali Cultural Elements */
        .bengali-touch {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            margin: 2rem 0;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .bengali-touch::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="50" font-size="40" opacity="0.1">🕉️</text></svg>') repeat;
            background-size: 50px 50px;
        }

        .bengali-touch h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            position: relative;
            z-index: 1;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-primary);
        }

        /* Alerts */
        .alert {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid var(--marigold);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* Footer Style */
        .site-footer {
            text-align: center;
            padding: 15px;
            background: #8B0000;
            color: #fff8dc;
            font-family: "Segoe UI", sans-serif;
            font-size: 1rem;
            margin-top: 20px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
        }

        .site-footer p {
            margin: 0;
            animation: fadeInUp 2s ease-in-out;
        }

        /* Highlight "Rohit" */
        .site-footer .rohit {
            color: gold;
            font-weight: bold;
            text-shadow: 0 0 5px #ff6347, 0 0 15px #ffd700;
            animation: glowText 2s infinite alternate;
        }

        /* Text glow */
        @keyframes glowText {
            from { text-shadow: 0 0 5px #ff4500, 0 0 10px #ffd700; }
            to   { text-shadow: 0 0 20px #ffa500, 0 0 30px #ffd700; }
        }

        /* Footer fade-in */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            box-shadow: 0 5px 20px rgba(40,167,69,0.4);
            z-index: 1002;
            font-weight: 500;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Cultural patterns */
        .pattern-bg {
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 153, 51, 0.1) 2px, transparent 2px),
                radial-gradient(circle at 80% 50%, rgba(220, 20, 60, 0.1) 2px, transparent 2px);
            background-size: 30px 30px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .pandal-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }

            .header-top {
                flex-direction: column;
                gap: 1rem;
            }

            .side-menu {
                width: 280px;
                right: -280px;
            }

            .weather-widget {
                min-width: 300px;
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body data-theme="light" class="pattern-bg">
    <!-- Side Menu Overlay -->
    <div class="side-menu-overlay" id="sideMenuOverlay"></div>
    
    <!-- Side Menu -->
    <div class="side-menu" id="sideMenu">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h3 data-en="Menu" data-bn="মেনু">Menu</h3>
            <button onclick="toggleSideMenu()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-primary);">×</button>
        </div>
        <div class="menu-item" onclick="showBookmarks()">
            <i class="fas fa-heart"></i>
            <span data-en="Bookmarked Pandals" data-bn="পছন্দের পণ্ডেল">Bookmarked Pandals</span>
        </div>
        <div class="menu-item" onclick="showMyRoute()">
            <i class="fas fa-route"></i>
            <span data-en="My Route" data-bn="আমার রুট">My Route</span>
        </div>
        <div class="menu-item" onclick="showAR()">
            <i class="fas fa-camera"></i>
            <span data-en="AR Pandal Finder" data-bn="এআর পণ্ডেল খুঁজুন">AR Pandal Finder</span>
        </div>
        <div class="menu-item" onclick="showThemeArchive()">
            <i class="fas fa-history"></i>
            <span data-en="Theme Archive" data-bn="থিম আর্কাইভ">Theme Archive</span>
        </div>
        <div class="menu-item" onclick="showSelfieWall()">
            <i class="fas fa-camera-retro"></i>
            <span data-en="Selfie Wall" data-bn="সেলফি ওয়াল">Selfie Wall</span>
        </div>
        <div class="menu-item" onclick="showBadges()">
            <i class="fas fa-trophy"></i>
            <span data-en="My Badges" data-bn="আমার ব্যাজ">My Badges</span>
        </div>
        <div class="menu-item" onclick="showWeatherInfo()">
            <i class="fas fa-cloud-sun"></i>
            <span data-en="Weather & Forecast" data-bn="আবহাওয়া ও পূর্বাভাস">Weather & Forecast</span>
        </div>
        <div class="menu-item" onclick="clearAllData()">
            <i class="fas fa-trash"></i>
            <span data-en="Clear All Data" data-bn="সব ডেটা মুছে ফেলুন">Clear All Data</span>
        </div>
        <div class="menu-item" onclick="shareApp()">
            <i class="fas fa-share"></i>
            <span data-en="Share App" data-bn="অ্যাপ শেয়ার করুন">Share App</span>
        </div>
    </div>

    <!-- Preloader -->
    <div id="preloader">
        <div class="welcome-box">
            <h1 class="puja-title">শুভ দুর্গাপূজা</h1>
            <p class="puja-subtitle">
                শারদীয়া দুর্গাপূজায় আপনাকে ও আপনার পরিবারকে জানাই আন্তরিক শুভেচ্ছা ও অভিনন্দন
            </p>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-top">
            <div class="logo-section">
                <div class="logo">🕉️</div>
                <div>
                    <h1 data-en="Kolkata Durga Puja Guide 2025" data-bn="কলকাতা দুর্গাপূজা গাইড ২০২৫">Kolkata Durga Puja Guide 2025</h1>
                    <p data-en="শুভ দুর্গোৎসব | North Kolkata Heritage Route" data-bn="শুভ দুর্গোৎসব | উত্তর কলকাতা ঐতিহ্য রুট">শুভ দুর্গোৎসব | North Kolkata Heritage Route</p>
                </div>
            </div>
            <div class="header-controls">
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Theme">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                <button class="lang-toggle" onclick="toggleLanguage()" title="Change Language">
                    <span id="langText">বাং</span>
                </button>
                <button class="menu-btn" onclick="toggleSideMenu()" title="Menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('pandals')">
                <i class="fas fa-building"></i>
                <span data-en="Pandals" data-bn="পণ্ডেল">Pandals</span>
            </button>
            <button class="nav-tab" onclick="showSection('map')">
                <i class="fas fa-map"></i>
                <span data-en="Map & Route" data-bn="মানচিত্র ও রুট">Map & Route</span>
            </button>
            <button class="nav-tab" onclick="showSection('emergency')">
                <i class="fas fa-shield-alt"></i>
                <span data-en="Safety" data-bn="নিরাপত্তা">Safety</span>
            </button>
            <button class="nav-tab" onclick="showSection('food')">
                <i class="fas fa-utensils"></i>
                <span data-en="Food & Culture" data-bn="খাবার ও সংস্কৃতি">Food & Culture</span>
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Pandals Section -->
        <div id="pandals" class="content-section active">
            <div class="search-container">
                <input type="text" class="search-input" data-placeholder-en="Search pandals by name, area, or theme..." data-placeholder-bn="নাম, এলাকা বা থিম দিয়ে পণ্ডেল খুঁজুন..." placeholder="Search pandals by name, area, or theme..." id="searchInput">
                <div class="filters">
                    <button class="filter-btn active" onclick="filterPandals('all')" data-en="All" data-bn="সব">All</button>
                    <button class="filter-btn" onclick="filterPandals('heritage')" data-en="Heritage" data-bn="ঐতিহ্য">Heritage</button>
                    <button class="filter-btn" onclick="filterPandals('theme')" data-en="Theme" data-bn="থিম">Theme</button>
                    <button class="filter-btn" onclick="filterPandals('community')" data-en="Community" data-bn="কমিউনিটি">Community</button>
                    <button class="filter-btn" onclick="filterPandals('accessible')" data-en="Wheelchair Accessible" data-bn="হুইলচেয়ার ব্যবহারযোগ্য">Wheelchair Accessible</button>
                </div>
            </div>

            <!-- Route Progress -->
            <div class="route-container">
                <h3 data-en="Your Route Progress" data-bn="আপনার রুট অগ্রগতি">Your Route Progress</h3>
                <div class="progress-container">
                    <div class="progress-bar" id="routeProgressBar"></div>
                </div>
                <div class="progress-text" id="progressText">0% Complete</div>
            </div>

            <div class="pandal-grid" id="pandalGrid">
                <!-- Sample Pandal Cards -->
                <div class="pandal-card">
                    <div class="crowd-indicator crowd-medium">Medium</div>
                    <div class="pandal-name">Tala Barowari</div>
                    <div class="pandal-type">Heritage</div>
                    <div class="pandal-details">
                        <div class="detail-item">
                            <span class="detail-icon">📍</span>
                            <span>Tala, North 24 Parganas</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">🎭</span>
                            <span>Traditional Bengali Architecture</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">⏰</span>
                            <span>6 AM - 11 PM</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">🚇</span>
                            <span>2.5 km from Dum Dum Metro</span>
                        </div>
                    </div>
                    <div>
                        <button class="btn">
                            <i class="fas fa-heart"></i>
                            Bookmark
                        </button>
                        <button class="btn">
                            <i class="fas fa-directions"></i>
                            Directions
                        </button>
                        <button class="btn">
                            <i class="fas fa-check"></i>
                            Mark Visited
                        </button>
                    </div>
                </div>

                <div class="pandal-card">
                    <div class="crowd-indicator crowd-high">High</div>
                    <div class="pandal-name">Shyambazar Rajbari</div>
                    <div class="pandal-type">Heritage</div>
                    <div class="pandal-details">
                        <div class="detail-item">
                            <span class="detail-icon">📍</span>
                            <span>Shyambazar Street</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">🎭</span>
                            <span>Royal Palace Theme</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">⏰</span>
                            <span>6 AM - 12 AM</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">🚇</span>
                            <span>500m from Shyambazar Metro</span>
                        </div>
                    </div>
                    <div>
                        <button class="btn">
                            <i class="fas fa-heart"></i>
                            Bookmark
                        </button>
                        <button class="btn">
                            <i class="fas fa-directions"></i>
                            Directions
                        </button>
                        <button class="btn">
                            <i class="fas fa-check"></i>
                            Mark Visited
                        </button>
                    </div>
                </div>

                <div class="pandal-card">
                    <div class="crowd-indicator crowd-low">Low</div>
                    <div class="pandal-name">Kumartuli Park</div>
                    <div class="pandal-type">Traditional</div>
                    <div class="pandal-details">
                        <div class="detail-item">
                            <span class="detail-icon">📍</span>
                            <span>Kumartuli, Sovabazar</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">🎭</span>
                            <span>Artisan's Quarter Theme</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">⏰</span>
                            <span>5 AM - 11 PM</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">🚇</span>
                            <span>1 km from Sovabazar Metro</span>
                        </div>
                    </div>
                    <div>
                        <button class="btn">
                            <i class="fas fa-heart"></i>
                            Bookmark
                        </button>
                        <button class="btn">
                            <i class="fas fa-directions"></i>
                            Directions
                        </button>
                        <button class="btn">
                            <i class="fas fa-check"></i>
                            Mark Visited
                        </button>
                    </div>
                </div>

                <div class="pandal-card">
                    <div class="crowd-indicator crowd-medium">Medium</div>
                    <div class="pandal-name">Santosh Mitra Square</div>
                    <div class="pandal-type">Theme</div>
                    <div class="pandal-details">
                        <div class="detail-item">
                            <span class="detail-icon">📍</span>
                            <span>Central Kolkata</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">🎭</span>
                            <span>Modern Art Installation</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">⏰</span>
                            <span>6 AM - 12 AM</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-icon">♿</span>
                            <span>Wheelchair Accessible</span>
                        </div>
                    </div>
                    <div>
                        <button class="btn">
                            <i class="fas fa-heart"></i>
                            Bookmark
                        </button>
                        <button class="btn">
                            <i class="fas fa-directions"></i>
                            Directions
                        </button>
                        <button class="btn">
                            <i class="fas fa-check"></i>
                            Mark Visited
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map Section -->
        <div id="map" class="content-section">
            <h2 data-en="🗺️ North Kolkata Heritage Route Map" data-bn="🗺️ উত্তর কলকাতা ঐতিহ্য রুট মানচিত্র">🗺️ North Kolkata Heritage Route Map</h2>
            
            <div class="route-container">
                <h3 data-en="📍 Suggested Route: Tala to Santosh Mitra Square" data-bn="📍 প্রস্তাবিত রুট: তালা থেকে সন্তোষ মিত্র স্কোয়ার">📍 Suggested Route: Tala to Santosh Mitra Square</h3>
                <p>
                    <strong data-en="Total Distance:" data-bn="মোট দূরত্ব:">Total Distance:</strong> ~12 km | 
                    <strong data-en="Time:" data-bn="সময়:">Time:</strong> 6-8 hours | 
                    <strong data-en="Best Time:" data-bn="সেরা সময়:">Best Time:</strong> Evening (4 PM - 11 PM)
                </p>
                
                <div class="route-controls" style="margin: 1rem 0; text-align: center;">
                    <button class="btn" onclick="startRouteNavigation()">
                        <i class="fas fa-play"></i>
                        <span data-en="Start Navigation" data-bn="নেভিগেশন শুরু করুন">Start Navigation</span>
                    </button>
                    <button class="btn" onclick="getCurrentLocation()">
                        <i class="fas fa-crosshairs"></i>
                        <span data-en="My Location" data-bn="আমার অবস্থান">My Location</span>
                    </button>
                    <button class="btn" onclick="optimizeRoute()">
                        <i class="fas fa-route"></i>
                        <span data-en="Optimize Route" data-bn="রুট অপ্টিমাইজ করুন">Optimize Route</span>
                    </button>
                </div>
            </div>
            
            <div id="mapContainer" style="height: 500px; border-radius: 15px; box-shadow: var(--shadow); background: #f0f0f0; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                <div style="text-align: center;">
                    <i class="fas fa-map" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                    <p>Interactive Map Loading...</p>
                </div>
            </div>
            
            <div class="route-container">
                <h3 data-en="🚦 Live Traffic & Road Updates" data-bn="🚦 লাইভ ট্রাফিক ও রাস্তার আপডেট">🚦 Live Traffic & Road Updates</h3>
                <div class="alert">
                    <strong data-en="⚠️ Traffic Alert:" data-bn="⚠️ ট্রাফিক সতর্কতা:">⚠️ Traffic Alert:</strong> 
                    <span data-en="Heavy congestion expected on Amherst Street (6 PM - 10 PM)" data-bn="অ্যামহার্স্ট স্ট্রিটে ভারী যানজট প্রত্যাশিত (সন্ধ্যা ৬টা - রাত ১০টা)">Heavy congestion expected on Amherst Street (6 PM - 10 PM)</span>
                </div>
                <div class="alert">
                    <strong data-en="🚧 Road Closure:" data-bn="🚧 রাস্তা বন্ধ:">🚧 Road Closure:</strong> 
                    <span data-en="College Street partially closed near Manicktolla" data-bn="মানিকতলার কাছে কলেজ স্ট্রিট আংশিকভাবে বন্ধ">College Street partially closed near Manicktolla</span>
                </div>
            </div>
        </div>

        <!-- Emergency Section -->
        <div id="emergency" class="content-section">
            <h2 data-en="🚨 Emergency & Safety Information" data-bn="🚨 জরুরি ও নিরাপত্তা তথ্য">🚨 Emergency & Safety Information</h2>
            
            <div class="emergency-grid">
                <div class="emergency-card">
                    <h3 data-en="🚓 Police" data-bn="🚓 পুলিশ">🚓 Police</h3>
                    <div class="emergency-number">100</div>
                    <p data-en="24/7 Emergency Helpline" data-bn="২৪/৭ জরুরি হেল্পলাইন">24/7 Emergency Helpline</p>
                </div>
                <div class="emergency-card">
                    <h3 data-en="🚑 Ambulance" data-bn="🚑 অ্যাম্বুলেন্স">🚑 Ambulance</h3>
                    <div class="emergency-number">102</div>
                    <p data-en="Medical Emergency" data-bn="চিকিৎসা জরুরি">Medical Emergency</p>
                </div>
                <div class="emergency-card">
                    <h3 data-en="🚒 Fire" data-bn="🚒 ফায়ার">🚒 Fire</h3>
                    <div class="emergency-number">101</div>
                    <p data-en="Fire Emergency" data-bn="অগ্নিকাণ্ড জরুরি">Fire Emergency</p>
                </div>
                <div class="emergency-card">
                    <h3 data-en="🏥 Medical" data-bn="🏥 চিকিৎসা">🏥 Medical</h3>
                    <div class="emergency-number">033-2286-1744</div>
                    <p data-en="SSKM Hospital" data-bn="এসএসকেএম হাসপাতাল">SSKM Hospital</p>
                </div>
            </div>

            <div class="route-container">
                <h3 data-en="🏥 Medical Facilities on Route" data-bn="🏥 রুটে চিকিৎসা সুবিধা">🏥 Medical Facilities on Route</h3>
                <div class="emergency-grid">
                    <div class="emergency-card" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <h4 data-en="Near Tala" data-bn="তালার কাছে">Near Tala</h4>
                        <p data-en="Tala Hospital<br>📍 Tala, North 24 Parganas" data-bn="তালা হাসপাতাল<br>📍 তালা, উত্তর ২৪ পরগনা">Tala Hospital<br>📍 Tala, North 24 Parganas</p>
                    </div>
                    <div class="emergency-card" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <h4 data-en="Shyambazar Area" data-bn="শ্যামবাজার এলাকা">Shyambazar Area</h4>
                        <p data-en="R.G. Kar Medical College<br>📍 Belgachia" data-bn="আর.জি. কর মেডিক্যাল কলেজ<br>📍 বেলগাছিয়া">R.G. Kar Medical College<br>📍 Belgachia</p>
                    </div>
                    <div class="emergency-card" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <h4 data-en="Central Kolkata" data-bn="মধ্য কলকাতা">Central Kolkata</h4>
                        <p data-en="Medical College Hospital<br>📍 College Street" data-bn="মেডিক্যাল কলেজ হাসপাতাল<br>📍 কলেজ স্ট্রিট">Medical College Hospital<br>📍 College Street</p>
                    </div>
                </div>
            </div>

            <!-- Safety Guidelines -->
            <div class="route-container">
                <h3 data-en="🛡️ Safety Guidelines" data-bn="🛡️ নিরাপত্তা নির্দেশিকা">🛡️ Safety Guidelines</h3>
                <div class="detail-item">
                    <span class="detail-icon">👥</span>
                    <span data-en="Stay with your group and avoid getting separated in crowds" data-bn="আপনার দলের সাথে থাকুন এবং ভিড়ে আলাদা হয়ে যাওয়া এড়িয়ে চলুন">Stay with your group and avoid getting separated in crowds</span>
                </div>
                <div class="detail-item">
                    <span class="detail-icon">💧</span>
                    <span data-en="Stay hydrated and carry water bottles" data-bn="হাইড্রেটেড থাকুন এবং পানির বোতল নিয়ে চলুন">Stay hydrated and carry water bottles</span>
                </div>
                <div class="detail-item">
                    <span class="detail-icon">📱</span>
                    <span data-en="Keep your phone charged and share your location with family" data-bn="আপনার ফোন চার্জ রাখুন এবং পরিবারের সাথে আপনার অবস্থান শেয়ার করুন">Keep your phone charged and share your location with family</span>
                </div>
                <div class="detail-item">
                    <span class="detail-icon">👜</span>
                    <span data-en="Keep valuables secure and avoid displaying expensive items" data-bn="মূল্যবান জিনিসগুলি নিরাপদে রাখুন এবং দামি জিনিস প্রদর্শন এড়িয়ে চলুন">Keep valuables secure and avoid displaying expensive items</span>
                </div>
            </div>
        </div>

        <!-- Food & Culture Section -->
        <div id="food" class="content-section">
            <h2 data-en="🍴 Food & Culture Guide" data-bn="🍴 খাদ্য ও সংস্কৃতি গাইড">🍴 Food & Culture Guide</h2>
            
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Search food items..." id="foodSearchInput">
                <div class="filters">
                    <button class="filter-btn active" onclick="filterFood('all')" data-en="All Food" data-bn="সব খাবার">All Food</button>
                    <button class="filter-btn" onclick="filterFood('street')" data-en="Street Food" data-bn="রাস্তার খাবার">Street Food</button>
                    <button class="filter-btn" onclick="filterFood('sweets')" data-en="Sweets" data-bn="মিষ্টি">Sweets</button>
                    <button class="filter-btn" onclick="filterFood('traditional')" data-en="Traditional" data-bn="ঐতিহ্যবাহী">Traditional</button>
                </div>
            </div>

            <div class="food-grid" id="foodGrid">
                <!-- Sample Food Cards -->
                <div class="food-card">
                    <h4>Kathi Roll</h4>
                    <div class="food-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        4.8/5
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">📍</span>
                        <span>Nizam's, New Market</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">💰</span>
                        <span>₹80 - ₹120</span>
                    </div>
                    <button class="btn">
                        <i class="fas fa-directions"></i>
                        Get Directions
                    </button>
                </div>

                <div class="food-card">
                    <h4>Rasgulla</h4>
                    <div class="food-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        4.9/5
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">📍</span>
                        <span>KC Das, Esplanade</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">💰</span>
                        <span>₹15 - ₹25 per piece</span>
                    </div>
                    <button class="btn">
                        <i class="fas fa-directions"></i>
                        Get Directions
                    </button>
                </div>

                <div class="food-card">
                    <h4>Fish Curry & Rice</h4>
                    <div class="food-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="far fa-star"></i>
                        4.5/5
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">📍</span>
                        <span>Bhojohori Manna, Shyambazar</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">💰</span>
                        <span>₹350 - ₹450</span>
                    </div>
                    <button class="btn">
                        <i class="fas fa-directions"></i>
                        Get Directions
                    </button>
                </div>

                <div class="food-card">
                    <h4>Puchka</h4>
                    <div class="food-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        4.7/5
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">📍</span>
                        <span>Street Vendors, College Street</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-icon">💰</span>
                        <span>₹20 - ₹30</span>
                    </div>
                    <button class="btn">
                        <i class="fas fa-directions"></i>
                        Get Directions
                    </button>
                </div>
            </div>

            <div class="route-container">
                <h3 data-en="📿 Cultural Etiquette & Tips" data-bn="📿 সাংস্কৃতিক শিষ্টাচার ও পরামর্শ">📿 Cultural Etiquette & Tips</h3>
                <div class="detail-item">
                    <span class="detail-icon">🙏</span>
                    <span data-en="Remove shoes before entering pandals (where required)" data-bn="পণ্ডেলে প্রবেশের আগে জুতা খুলে রাখুন (যেখানে প্রয়োজন)">Remove shoes before entering pandals (where required)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-icon">📸</span>
                    <span data-en="Ask permission before photographing people" data-bn="মানুষের ছবি তোলার আগে অনুমতি নিন">Ask permission before photographing people</span>
                </div>
                <div class="detail-item">
                    <span class="detail-icon">👥</span>
                    <span data-en="Follow crowd management instructions" data-bn="ভিড় নিয়ন্ত্রণের নির্দেশাবলী মেনে চলুন">Follow crowd management instructions</span>
                </div>
                <div class="detail-item">
                    <span class="detail-icon">💰</span>
                    <span data-en="Carry small change for offerings (₹5-20)" data-bn="উৎসর্গের জন্য ছোট টাকা রাখুন (₹৫-২০)">Carry small change for offerings (₹5-20)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-icon">🌺</span>
                    <span data-en="Traditional greeting: \"শুভ দুর্গোৎসব\" (Shubho Durgotsav)" data-bn="ঐতিহ্যবাহী অভিবাদন: \"শুভ দুর্গোৎসব\"">Traditional greeting: "শুভ দুর্গোৎসব" (Shubho Durgotsav)</span>
                </div>
            </div>

            <!-- Bengali Calendar -->
            <div class="route-container">
                <h3 data-en="📅 Puja Calendar 2025" data-bn="📅 পূজা ক্যালেন্ডার ২০২৫">📅 Puja Calendar 2025</h3>
                <div class="emergency-grid">
                    <div class="emergency-card" style="background: linear-gradient(135deg, var(--saffron), var(--marigold));">
                        <h4 data-en="Mahalaya" data-bn="মহালয়া">Mahalaya</h4>
                        <p data-en="September 17, 2025" data-bn="১৭ সেপ্টেম্বর, ২০২৫">September 17, 2025</p>
                    </div>
                    <div class="emergency-card" style="background: linear-gradient(135deg, var(--vermillion), var(--primary-color));">
                        <h4 data-en="Shashthi" data-bn="ষষ্ঠী">Shashthi</h4>
                        <p data-en="October 1, 2025" data-bn="১ অক্টোবর, ২০২৫">October 1, 2025</p>
                    </div>
                    <div class="emergency-card" style="background: linear-gradient(135deg, var(--gold), var(--saffron));">
                        <h4 data-en="Saptami" data-bn="সপ্তমী">Saptami</h4>
                        <p data-en="October 2, 2025" data-bn="২ অক্টোবর, ২০২৫">October 2, 2025</p>
                    </div>
                    <div class="emergency-card" style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));">
                        <h4 data-en="Ashtami" data-bn="অষ্টমী">Ashtami</h4>
                        <p data-en="October 3, 2025" data-bn="৩ অক্টোবর, ২০২৫">October 3, 2025</p>
                    </div>
                    <div class="emergency-card" style="background: linear-gradient(135deg, var(--marigold), var(--gold));">
                        <h4 data-en="Navami" data-bn="নবমী">Navami</h4>
                        <p data-en="October 4, 2025" data-bn="৪ অক্টোবর, ২০২৫">October 4, 2025</p>
                    </div>
                    <div class="emergency-card" style="background: linear-gradient(135deg, var(--accent-color), var(--accent-secondary));">
                        <h4 data-en="Dashami" data-bn="দশমী">Dashami</h4>
                        <p data-en="October 5, 2025" data-bn="৫ অক্টোবর, ২০২৫">October 5, 2025</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="arModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('arModal')">&times;</button>
            <h2 data-en="AR Pandal Finder" data-bn="এআর পণ্ডেল খুঁজুন">AR Pandal Finder</h2>
            <div class="ar-container">
                <div id="arCamera">
                    <div class="ar-overlay">
                        <h3 data-en="Point camera at surroundings" data-bn="ক্যামেরা আশেপাশে নির্দেশ করুন">Point camera at surroundings</h3>
                        <p data-en="AR markers will show nearby pandals" data-bn="এআর মার্কার কাছাকাছি পণ্ডেল দেখাবে">AR markers will show nearby pandals</p>
                        <div class="ar-pointer" style="top: 30%; left: 40%;">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div style="position: absolute; top: 25%; left: 35%; color: white; font-size: 0.8rem;">
                            Tala Puja - 500m
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="startARCamera()">
                    <i class="fas fa-camera"></i>
                    <span data-en="Start AR Navigation" data-bn="এআর নেভিগেশন শুরু করুন">Start AR Navigation</span>
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="themeArchiveModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('themeArchiveModal')">&times;</button>
            <h2 data-en="Theme Archive (2019-2024)" data-bn="থিম আর্কাইভ (২০১৯-২০২৪)">Theme Archive (2019-2024)</h2>
            <div class="photo-grid" id="themeArchiveGrid">
                <div class="photo-item">
                    <div style="background: var(--accent-color); height: 200px; display: flex; align-items: center; justify-content: center; color: white; border-radius: 10px;">
                        2024 Themes Loading...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="selfieModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('selfieModal')">&times;</button>
            <h2 data-en="Festival Selfie Wall" data-bn="উৎসবের সেলফি ওয়াল">Festival Selfie Wall</h2>
            <div style="text-align: center; margin: 1rem 0;">
                <button class="btn" onclick="capturePhoto()">
                    <i class="fas fa-camera"></i>
                    <span data-en="Take Selfie" data-bn="সেলফি তুলুন">Take Selfie</span>
                </button>
                <input type="file" id="photoUpload" accept="image/*" style="display: none;" onchange="uploadPhoto()">
                <button class="btn" onclick="document.getElementById('photoUpload').click()">
                    <i class="fas fa-upload"></i>
                    <span data-en="Upload Photo" data-bn="ছবি আপলোড করুন">Upload Photo</span>
                </button>
            </div>
            <div class="photo-grid" id="selfieGrid">
                <div class="photo-item">
                    <div style="background: var(--border-color); height: 200px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); border-radius: 10px;">
                        Your Selfies Here
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="badgesModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('badgesModal')">&times;</button>
            <h2 data-en="Achievement Badges" data-bn="অর্জনের ব্যাজ">Achievement Badges</h2>
            <div class="badge-container" id="badgeContainer">
                <div class="badge">
                    <i class="fas fa-star"></i>
                    <span>First Visit</span>
                </div>
                <div class="badge locked">
                    <i class="fas fa-lock"></i>
                    <span>Heritage Explorer</span>
                </div>
                <div class="badge locked">
                    <i class="fas fa-lock"></i>
                    <span>Photo Enthusiast</span>
                </div>
                <div class="badge locked">
                    <i class="fas fa-lock"></i>
                    <span>Route Master</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Weather Widget -->
    <div class="weather-widget" id="weatherWidget" style="display: none;">
        <button class="weather-close" onclick="hideWeatherWidget()">&times;</button>
        <h3 data-en="Weather Forecast" data-bn="আবহাওয়ার পূর্বাভাস">Weather Forecast</h3>
        <div class="weather-current">
            <div style="font-size: 3rem;">🌤️</div>
            <div class="weather-temp">28°C</div>
            <div class="weather-desc">Partly Cloudy</div>
            <div class="weather-details">
                <div>Humidity: 65%</div>
                <div>Wind: 12 km/h</div>
                <div>Feels like: 31°C</div>
                <div>UV Index: 6</div>
            </div>
        </div>
        <div class="weather-forecast">
            <h4>5-Day Forecast</h4>
            <div class="forecast-day">
                <span>Today</span>
                <span>🌤️ 28°/22°</span>
            </div>
            <div class="forecast-day">
                <span>Tomorrow</span>
                <span>🌧️ 25°/20°</span>
            </div>
            <div class="forecast-day">
                <span>Oct 3</span>
                <span>☀️ 30°/24°</span>
            </div>
            <div class="forecast-day">
                <span>Oct 4</span>
                <span>🌤️ 29°/23°</span>
            </div>
            <div class="forecast-day">
                <span>Oct 5</span>
                <span>🌧️ 26°/21°</span>
            </div>
        </div>
    </div>

    <!-- Floating Action Buttons -->
    <button class="fab" onclick="showBookmarks()" title="Bookmarked Pandals">
        ❤️
    </button>
    <button class="sos-button" onclick="triggerSOS()" title="Emergency SOS">
        SOS
    </button>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Footer -->
    <footer class="site-footer">
        <p>
            ✨ 
            <span data-en="Made with ❤️ by" data-bn="ভালোবাসায় নির্মিত">Made with ❤️ by</span> 
            <span class="rohit" data-en="Rohit" data-bn="রোহিত">Rohit</span> 
            ✨
        </p>
    </footer>

    <!-- Leaflet JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    
    <script>
        // Dynamic Weather data that updates automatically based on current date
        function generateWeatherData() {
            const today = new Date();
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const daysBengali = ['রবিবার', 'সোমবার', 'মঙ্গলবার', 'বুধবার', 'বৃহস্পতিবার', 'শুক্রবার', 'শনিবার'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            
            // Weather patterns that cycle based on the day of year
            const weatherPatterns = [
                {
                    condition: { en: "Sunny", bn: "রৌদ্রোজ্জ্বল" },
                    icon: "☀️",
                    tempRange: { high: [30, 35], low: [22, 27] },
                    humidity: [45, 65],
                    rain: [5, 20]
                },
                {
                    condition: { en: "Partly Cloudy", bn: "আংশিক মেঘলা" },
                    icon: "⛅",
                    tempRange: { high: [28, 33], low: [20, 25] },
                    humidity: [55, 75],
                    rain: [15, 35]
                },
                {
                    condition: { en: "Cloudy", bn: "মেঘলা" },
                    icon: "☁️",
                    tempRange: { high: [25, 30], low: [18, 23] },
                    humidity: [65, 85],
                    rain: [25, 45]
                },
                {
                    condition: { en: "Light Rain", bn: "হালকা বৃষ্টি" },
                    icon: "🌦️",
                    tempRange: { high: [24, 29], low: [17, 22] },
                    humidity: [70, 90],
                    rain: [60, 80]
                },
                {
                    condition: { en: "Heavy Rain", bn: "ভারী বৃষ্টি" },
                    icon: "🌧️",
                    tempRange: { high: [22, 27], low: [15, 20] },
                    humidity: [80, 95],
                    rain: [80, 95]
                },
                {
                    condition: { en: "Thunderstorms", bn: "বজ্রবৃষ্টি" },
                    icon: "⛈️",
                    tempRange: { high: [23, 28], low: [16, 21] },
                    humidity: [75, 95],
                    rain: [85, 100]
                },
                {
                    condition: { en: "Hot & Humid", bn: "গরম ও আর্দ্র" },
                    icon: "🌤️",
                    tempRange: { high: [32, 38], low: [24, 29] },
                    humidity: [70, 90],
                    rain: [10, 40]
                }
            ];
            
            // Function to get weather pattern based on date
            function getWeatherPattern(dateOffset = 0) {
                const targetDate = new Date(today);
                targetDate.setDate(targetDate.getDate() + dateOffset);
                
                // Use day of year to create consistent but varied weather
                const dayOfYear = Math.floor((targetDate - new Date(targetDate.getFullYear(), 0, 0)) / 86400000);
                
                // Create some seasonal variation
                const month = targetDate.getMonth();
                let basePatternIndex;
                
                // Seasonal weather patterns for Kolkata
                if (month >= 2 && month <= 5) { // March-June (Hot season)
                    basePatternIndex = (dayOfYear % 3) + 4; // Hot, sunny, or thunderstorms
                } else if (month >= 6 && month <= 9) { // July-October (Monsoon)
                    basePatternIndex = (dayOfYear % 4) + 2; // Cloudy, rainy patterns
                } else { // November-February (Winter/Pleasant)
                    basePatternIndex = (dayOfYear % 3); // Sunny, partly cloudy, cloudy
                }
                
                return weatherPatterns[basePatternIndex % weatherPatterns.length];
            }
            
            // Function to generate random value within range
            function randomInRange(range) {
                return Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0];
            }
            
            // Get current weather
            const currentPattern = getWeatherPattern(0);
            const currentTemp = randomInRange(currentPattern.tempRange.high) - 2; // Current is usually between high and low
            
            // Generate forecast data
            const forecast = [];
            for (let i = 0; i < 6; i++) {
                const forecastDate = new Date(today);
                forecastDate.setDate(forecastDate.getDate() + i);
                
                const dayName = i === 0 ? { en: "Today", bn: "আজ" } : 
                               i === 1 ? { en: "Tomorrow", bn: "কাল" } : 
                               { en: days[forecastDate.getDay()], bn: daysBengali[forecastDate.getDay()] };
                
                const dateString = `${months[forecastDate.getMonth()]} ${forecastDate.getDate()}`;
                const pattern = getWeatherPattern(i);
                
                forecast.push({
                    day: dayName,
                    date: dateString,
                    condition: pattern.condition,
                    high: randomInRange(pattern.tempRange.high),
                    low: randomInRange(pattern.tempRange.low),
                    rain: randomInRange(pattern.rain),
                    icon: pattern.icon
                });
            }
            
            return {
                current: {
                    temp: currentTemp,
                    condition: currentPattern.condition,
                    humidity: randomInRange(currentPattern.humidity),
                    windSpeed: Math.floor(Math.random() * 15) + 5, // 5-20 km/h
                    visibility: Math.floor(Math.random() * 6) + 5, // 5-10 km
                    uvIndex: Math.floor(Math.random() * 8) + 3, // 3-10
                    feelsLike: currentTemp + Math.floor(Math.random() * 6) + 2, // +2 to +8 degrees
                    icon: currentPattern.icon
                },
                forecast: forecast
            };
        }

        // Global Variables
        let currentLanguage = 'en';
        let currentTheme = 'light';
        let currentFilter = 'all';
        let userLocation = null;
        let bookmarkedPandals = new Set();
        let visitedPandals = new Set();
        let routeProgress = 0;
        let isNavigating = false;
        let map = null;

        // Get weather data
        const weatherData = generateWeatherData();

        // Pandal data with corrected structure
        const pandals = [
            {
                id: 1,
                name: { en: "Tala Prally Durga Puja Committee", bn: "তালা প্রল্লয় দুর্গাপূজা কমিটি" },
                street: { en: "Tala, Barasat Road", bn: "তালা, বারাসাত রোড" },
                locality: { en: "Tala", bn: "তালা" },
                metro: { en: "2.5 km from Dum Dum Metro", bn: "দমদম মেট্রো থেকে ২.৫ কিমি" },
                coordinates: [22.6428, 88.3832],
                theme: { en: "Traditional Bengali Heritage", bn: "ঐতিহ্যবাহী বাঙালি ঐতিহ্য" },
                timing: { en: "6 AM - 11 PM", bn: "সকাল ৬টা - রাত ১১টা" },
                type: "heritage",
                accessibility: true,
                crowdLevel: "medium",
                waitTime: "15 mins",
                description: { en: "One of North Kolkata's heritage pujas with traditional decorations", bn: "উত্তর কলকাতার একটি ঐতিহ্যবাহী পূজা" }
            },
            {
                id: 2,
                name: { en: "Sovabazar Rajbari", bn: "শোভাবাজার রাজবাড়ি" },
                street: { en: "Raja Naba Krishna Street", bn: "রাজা নবকৃষ্ণ স্ট্রিট" },
                locality: { en: "Sovabazar", bn: "শোভাবাজার" },
                metro: { en: "500m from Sovabazar Metro", bn: "শোভাবাজার মেট্রো থেকে ৫০০ মি" },
                coordinates: [22.6067, 88.3489],
                theme: { en: "Royal Heritage Durga Puja", bn: "রাজকীয় ঐতিহ্যবাহী দুর্গাপূজা" },
                timing: { en: "6 AM - 12 AM", bn: "সকাল ৬টা - মধ্যরাত ১২টা" },
                type: "heritage",
                accessibility: false,
                crowdLevel: "high",
                waitTime: "45 mins",
                description: { en: "250+ year old heritage puja in royal palace", bn: "রাজপ্রাসাদে ২৫০+ বছরের পুরনো ঐতিহ্যবাহী পূজা" }
            },
            {
                id: 3,
                name: { en: "Kumartuli Park", bn: "কুমারটুলি পার্ক" },
                street: { en: "Kumartuli Street", bn: "কুমারটুলি স্ট্রিট" },
                locality: { en: "Sovabazar", bn: "শোভাবাজার" },
                metro: { en: "1 km from Sovabazar Metro", bn: "শোভাবাজার মেট্রো থেকে ১ কিমি" },
                coordinates: [22.5845, 88.3489],
                theme: { en: "Artisan's Quarter Theme", bn: "কারিগরদের পাড়ার থিম" },
                timing: { en: "5 AM - 11 PM", bn: "সকাল ৫টা - রাত ১১টা" },
                type: "community",
                accessibility: true,
                crowdLevel: "low",
                waitTime: "10 mins",
                description: { en: "Famous artisan community puja", bn: "বিখ্যাত কারিগর সম্প্রদায়ের পূজা" }
            },
            {
                id: 4,
                name: { en: "Santosh Mitra Square", bn: "সন্তোষ মিত্র স্কোয়ার" },
                street: { en: "Cornwallis Street", bn: "কর্নওয়ালিস স্ট্রিট" },
                locality: { en: "Central Kolkata", bn: "মধ্য কলকাতা" },
                metro: { en: "Walking distance from Central Metro", bn: "সেন্ট্রাল মেট্রো থেকে হাঁটা দূরত্ব" },
                coordinates: [22.5667, 88.3545],
                theme: { en: "Grand Finale Theme", bn: "মহান সমাপনী থিম" },
                timing: { en: "6 AM - 12 AM", bn: "সকাল ৬টা - মধ্যরাত ১২টা" },
                type: "theme",
                accessibility: true,
                crowdLevel: "high",
                waitTime: "60 mins",
                description: { en: "Famous for elaborate themes and massive crowds", bn: "বিস্তৃত থিম এবং বিশাল ভিড়ের জন্য বিখ্যাত" }
            }
        ];

        // Food data
        const foodItems = [
            {
                id: 1,
                name: { en: "Puchka", bn: "ফুচকা" },
                description: { en: "Bengali pani puri", bn: "বাঙালি পানি পুরি" },
                location: { en: "Street corners everywhere", bn: "সর্বত্র রাস্তার কোণে" },
                price: { en: "₹20-30 for 6", bn: "৬টির জন্য ₹২০-৩০" },
                rating: 4.5,
                category: "street"
            },
            {
                id: 2,
                name: { en: "Rosogolla", bn: "রসগোল্লা" },
                description: { en: "Bengal's signature sweet", bn: "বাংলার স্বাক্ষর মিষ্টি" },
                location: { en: "Sweet shops", bn: "মিষ্টির দোকান" },
                price: { en: "₹10-15 per piece", bn: "প্রতিটি ₹১০-১৫" },
                rating: 4.8,
                category: "sweets"
            },
            {
                id: 3,
                name: { en: "Khichdi Bhog", bn: "খিচুড়ি ভোগ" },
                description: { en: "Traditional offering at pandals", bn: "পণ্ডেলে ঐতিহ্যবাহী উৎসর্গ" },
                location: { en: "Available at most pandals", bn: "বেশিরভাগ পণ্ডেলে পাওয়া যায়" },
                price: { en: "Free (Prasadam)", bn: "বিনামূল্যে (প্রসাদাম)" },
                rating: 4.3,
                category: "traditional"
            }
        ];

        // Initialize app
        function init() {
            loadSavedData();
            loadSettings();
            loadPandals();
            loadFood();
            updateLanguageContent();
            updateProgress();
            loadRoute();
            updateDateTime();
            
            // Add event listeners
            document.getElementById('searchInput').addEventListener('input', filterAndSearch);
            document.getElementById('foodSearchInput').addEventListener('input', () => filterFood());
            
            // Close modals when clicking overlay
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    e.target.classList.remove('active');
                }
                if (e.target.classList.contains('side-menu-overlay')) {
                    toggleSideMenu();
                }
            });
            
            // Update time every minute
            setInterval(updateDateTime, 60000);
            
            console.log('App initialized successfully');
        }

        // Language and Theme Functions
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'bn' : 'en';
            document.getElementById('langText').textContent = currentLanguage === 'en' ? 'বাং' : 'ENG';
            updateLanguageContent();
            saveSettings();
        }

        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', currentTheme);
            document.getElementById('themeIcon').className = currentTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            saveSettings();
        }

        function updateLanguageContent() {
            document.querySelectorAll('[data-en]').forEach(el => {
                const text = currentLanguage === 'en' ? el.getAttribute('data-en') : el.getAttribute('data-bn');
                if (text) el.textContent = text;
            });
            
            // Update placeholders
            const searchInput = document.getElementById('searchInput');
            const placeholder = currentLanguage === 'en' ? 
                searchInput.getAttribute('data-placeholder-en') : 
                searchInput.getAttribute('data-placeholder-bn');
            if (placeholder) searchInput.placeholder = placeholder;
            
            loadPandals();
            loadFood();
        }

        // Navigation Functions
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const targetSection = sectionName === 'map' ? 'map' : sectionName;
            const sectionElement = document.getElementById(targetSection);
            if (sectionElement) {
                sectionElement.classList.add('active');
            }
            
            // Find and activate the corresponding tab
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                const onclick = tab.getAttribute('onclick');
                if (onclick && onclick.includes(sectionName)) {
                    tab.classList.add('active');
                }
            });
            
            if (sectionName === 'map') {
                setTimeout(() => {
                    if (!map) {
                        initMap();
                    } else {
                        map.invalidateSize();
                    }
                }, 100);
            }
        }

        function toggleSideMenu() {
            const menu = document.getElementById('sideMenu');
            const overlay = document.getElementById('sideMenuOverlay');
            
            menu.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        // Pandal Functions
        function loadPandals() {
            const grid = document.getElementById('pandalGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            pandals.forEach(pandal => {
                const card = createPandalCard(pandal);
                grid.appendChild(card);
            });
        }

        function createPandalCard(pandal) {
            const div = document.createElement('div');
            const isBookmarked = bookmarkedPandals.has(pandal.id);
            const isVisited = visitedPandals.has(pandal.id);
            
            div.className = `pandal-card ${isVisited ? 'visited' : ''}`;
            div.setAttribute('data-type', pandal.type);
            div.setAttribute('data-name', pandal.name[currentLanguage].toLowerCase());
            div.setAttribute('data-location', pandal.locality[currentLanguage].toLowerCase());
            div.setAttribute('data-accessible', pandal.accessibility);
            
            const crowdClass = pandal.crowdLevel === 'low' ? 'crowd-low' : 
                              pandal.crowdLevel === 'medium' ? 'crowd-medium' : 'crowd-high';
            const crowdText = pandal.crowdLevel === 'low' ? 
                (currentLanguage === 'en' ? 'Low' : 'কম') : 
                pandal.crowdLevel === 'medium' ? 
                (currentLanguage === 'en' ? 'Medium' : 'মধ্যম') : 
                (currentLanguage === 'en' ? 'High' : 'বেশি');
            
            div.innerHTML = `
                <div class="crowd-indicator ${crowdClass}">${crowdText}</div>
                <div class="pandal-name">${pandal.name[currentLanguage]}</div>
                <div class="pandal-type">${pandal.type.charAt(0).toUpperCase() + pandal.type.slice(1)}</div>
                <div class="pandal-details">
                    <div class="detail-item">
                        <i class="fas fa-map-marker-alt detail-icon"></i>
                        <span>${pandal.street[currentLanguage]}</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-subway detail-icon"></i>
                        <span>${pandal.metro[currentLanguage]}</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-palette detail-icon"></i>
                        <span>${pandal.theme[currentLanguage]}</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-clock detail-icon"></i>
                        <span>${pandal.timing[currentLanguage]}</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-users detail-icon"></i>
                        <span>${currentLanguage === 'en' ? 'Wait' : 'অপেক্ষা'}: ${pandal.waitTime}</span>
                    </div>
                    ${pandal.accessibility ? `
                        <div class="detail-item">
                            <i class="fas fa-wheelchair detail-icon"></i>
                            <span>${currentLanguage === 'en' ? 'Wheelchair Accessible' : 'হুইলচেয়ার ব্যবহারযোগ্য'}</span>
                        </div>
                    ` : ''}
                </div>
                <div style="margin-top: 1rem;">
                    <button class="btn ${isBookmarked ? 'bookmarked' : ''}" onclick="toggleBookmark(${pandal.id})">
                        <i class="fas fa-heart"></i>
                        ${isBookmarked ? 
                          (currentLanguage === 'en' ? 'Bookmarked' : 'পছন্দের তালিকায়') : 
                          (currentLanguage === 'en' ? 'Bookmark' : 'পছন্দ করুন')}
                    </button>
                    <button class="btn ${isVisited ? 'reached' : ''}" onclick="markAsReached(${pandal.id})">
                        <i class="fas fa-check"></i>
                        ${isVisited ? 
                          (currentLanguage === 'en' ? 'Visited' : 'দেখা হয়েছে') : 
                          (currentLanguage === 'en' ? 'Mark Visited' : 'দেখা হয়েছে চিহ্নিত করুন')}
                    </button>
                    <button class="btn" onclick="showRoute(${pandal.id})">
                        <i class="fas fa-directions"></i>
                        ${currentLanguage === 'en' ? 'Directions' : 'দিকনির্দেশ'}
                    </button>
                </div>
            `;
            
            return div;
        }

        function filterPandals(type) {
            currentFilter = type;
            
            // Update filter button states
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            filterAndSearch();
        }

        function filterAndSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const cards = document.querySelectorAll('.pandal-card');
            
            cards.forEach(card => {
                const type = card.getAttribute('data-type');
                const name = card.getAttribute('data-name');
                const location = card.getAttribute('data-location');
                const isAccessible = card.getAttribute('data-accessible') === 'true';
                
                let typeMatch = currentFilter === 'all' || 
                               type === currentFilter ||
                               (currentFilter === 'accessible' && isAccessible);
                
                let searchMatch = searchTerm === '' || 
                                 name.includes(searchTerm) || 
                                 location.includes(searchTerm);
                
                card.style.display = (typeMatch && searchMatch) ? 'block' : 'none';
            });
        }

        function toggleBookmark(pandalId) {
            const wasBookmarked = bookmarkedPandals.has(pandalId);
            if (wasBookmarked) {
                bookmarkedPandals.delete(pandalId);
            } else {
                bookmarkedPandals.add(pandalId);
            }
            
            const pandal = pandals.find(p => p.id === pandalId);
            const message = wasBookmarked ? 
                (currentLanguage === 'en' ? `Removed ${pandal.name.en} from bookmarks` : `${pandal.name.bn} পছন্দের তালিকা থেকে সরানো হয়েছে`) :
                (currentLanguage === 'en' ? `Added ${pandal.name.en} to bookmarks` : `${pandal.name.bn} পছন্দের তালিকায় যোগ করা হয়েছে`);
            
            showToast(message);
            loadPandals();
            saveData();
        }

        function markAsReached(pandalId) {
            if (!visitedPandals.has(pandalId)) {
                visitedPandals.add(pandalId);
                const pandal = pandals.find(p => p.id === pandalId);
                
                // Celebration effect
                createConfetti();
                
                const message = currentLanguage === 'en' ? 
                    `🎉 Destination Reached: ${pandal.name.en}!` : 
                    `🎉 গন্তব্যে পৌঁছেছেন: ${pandal.name.bn}!`;
                
                showToast(message);
                loadPandals();
                updateProgress();
                saveData();
            }
        }

        function showRoute(pandalId) {
            showSection('map');
            const pandal = pandals.find(p => p.id === pandalId);
            if (pandal && map) {
                map.setView(pandal.coordinates, 16);
            }
        }

        // Map Functions
        function initMap() {
            const mapContainer = document.getElementById('mapContainer');
            if (mapContainer) {
                mapContainer.innerHTML = '<div id="leafletMap" style="height: 100%; width: 100%;"></div>';
            }
            
            map = L.map('leafletMap').setView([22.6000, 88.3600], 12);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
            
            // Add pandal markers
            pandals.forEach((pandal, index) => {
                const isVisited = visitedPandals.has(pandal.id);
                
                const marker = L.marker(pandal.coordinates).addTo(map);
                marker.bindPopup(`
                    <div style="min-width: 200px;">
                        <h4 style="color: #8B0000; margin-bottom: 8px;">${pandal.name[currentLanguage]}</h4>
                        <p style="margin: 4px 0;"><strong>📍</strong> ${pandal.street[currentLanguage]}</p>
                        <p style="margin: 4px 0;"><strong>🎭</strong> ${pandal.theme[currentLanguage]}</p>
                        <p style="margin: 4px 0;"><strong>⏰</strong> ${pandal.timing[currentLanguage]}</p>
                        <p style="margin: 4px 0;"><strong>${currentLanguage === 'en' ? 'Route Step:' : 'রুট স্টেপ:'}</strong> ${index + 1}</p>
                        ${isVisited ? `<p style="margin: 4px 0; color: green; font-weight: bold;">✅ ${currentLanguage === 'en' ? 'Visited' : 'দেখা হয়েছে'}</p>` : ''}
                    </div>
                `);
            });
            
            // Add route line
            const coordinates = pandals.map(p => p.coordinates);
            L.polyline(coordinates, {
                color: '#ff6b35',
                weight: 4,
                opacity: 0.8,
                dashArray: '10, 5'
            }).addTo(map);
        }

        // Route and Progress Functions
        function loadRoute() {
            updateProgress();
        }

        function updateProgress() {
            const totalPandals = pandals.length;
            const visitedCount = visitedPandals.size;
            const progress = (visitedCount / totalPandals) * 100;
            
            routeProgress = progress;
            
            const progressBar = document.getElementById('routeProgressBar');
            const progressText = document.getElementById('progressText');
            
            if (progressBar) progressBar.style.width = `${progress}%`;
            if (progressText) {
                const text = currentLanguage === 'en' ? 
                    `${visitedCount}/${totalPandals} Pandals Visited (${Math.round(progress)}% Complete)` :
                    `${visitedCount}/${totalPandals} পণ্ডেল দেখা হয়েছে (${Math.round(progress)}% সম্পূর্ণ)`;
                progressText.textContent = text;
            }
        }

        function startRouteNavigation() {
            if (!userLocation) {
                getCurrentLocation(() => {
                    isNavigating = true;
                    showToast(currentLanguage === 'en' ? 'Navigation started!' : 'নেভিগেশন শুরু হয়েছে!');
                });
            } else {
                isNavigating = true;
                showToast(currentLanguage === 'en' ? 'Navigation started!' : 'নেভিগেশন শুরু হয়েছে!');
            }
        }

        function getCurrentLocation(callback) {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    userLocation = [position.coords.latitude, position.coords.longitude];
                    if (map) {
                        // Add user location marker
                        if (window.userMarker) {
                            map.removeLayer(window.userMarker);
                        }
                        window.userMarker = L.marker(userLocation)
                            .addTo(map)
                            .bindPopup(currentLanguage === 'en' ? 'Your Location' : 'আপনার অবস্থান');
                        map.setView(userLocation, 14);
                    }
                    if (callback) callback();
                    showToast(currentLanguage === 'en' ? 'Location found!' : 'অবস্থান পাওয়া গেছে!');
                }, (error) => {
                    showToast(currentLanguage === 'en' ? 'Could not get your location' : 'আপনার অবস্থান পাওয়া যাচ্ছে না', 'error');
                });
            } else {
                showToast(currentLanguage === 'en' ? 'Geolocation not supported' : 'জিওলোকেশন সমর্থিত নয়', 'error');
            }
        }

        function optimizeRoute() {
            if (!userLocation) {
                showToast(currentLanguage === 'en' ? 'Please allow location access first' : 'প্রথমে অবস্থানের অনুমতি দিন', 'warning');
                return;
            }
            
            showToast(currentLanguage === 'en' ? 'Route optimized based on your location!' : 'আপনার অবস্থানের ভিত্তিতে রুট অপ্টিমাইজ করা হয়েছে!');
        }

        // Food Functions
        function loadFood() {
            const foodGrid = document.getElementById('foodGrid');
            if (!foodGrid) return;
            
            foodGrid.innerHTML = '';
            
            foodItems.forEach(food => {
                const card = createFoodCard(food);
                foodGrid.appendChild(card);
            });
        }

        function createFoodCard(food) {
            const div = document.createElement('div');
            div.className = 'food-card';
            div.setAttribute('data-category', food.category);
            
            const stars = '★'.repeat(Math.floor(food.rating)) + '☆'.repeat(5 - Math.floor(food.rating));
            
            div.innerHTML = `
                <h4 style="color: var(--primary-color); margin-bottom: 8px;">${food.name[currentLanguage]}</h4>
                <p style="font-size: 0.9em; margin-bottom: 8px;">${food.description[currentLanguage]}</p>
                <div class="detail-item">
                    <i class="fas fa-map-marker-alt detail-icon"></i>
                    <span>${food.location[currentLanguage]}</span>
                </div>
                <div class="detail-item">
                    <i class="fas fa-tag detail-icon"></i>
                    <span>${food.price[currentLanguage]}</span>
                </div>
                <div class="food-rating">
                    ${stars} (${food.rating})
                </div>
                <button class="btn" onclick="findNearbyFood('${food.name.en}')">
                    <i class="fas fa-search"></i>
                    ${currentLanguage === 'en' ? 'Find Nearby' : 'কাছাকাছি খুঁজুন'}
                </button>
            `;
            
            return div;
        }

        function filterFood(category = 'all') {
            if (category !== 'all') {
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
            }
            
            const searchTerm = document.getElementById('foodSearchInput')?.value.toLowerCase() || '';
            const cards = document.querySelectorAll('.food-card');
            
            cards.forEach(card => {
                const cardCategory = card.getAttribute('data-category');
                const name = card.querySelector('h4').textContent.toLowerCase();
                const description = card.querySelector('p').textContent.toLowerCase();
                
                const matchesCategory = category === 'all' || cardCategory === category;
                const matchesSearch = name.includes(searchTerm) || description.includes(searchTerm);
                
                card.style.display = matchesCategory && matchesSearch ? 'block' : 'none';
            });
        }

        function findNearbyFood(foodName) {
            if (userLocation) {
                const query = `${foodName} near ${userLocation[0]},${userLocation[1]}`;
                const url = `https://www.google.com/maps/search/${encodeURIComponent(query)}`;
                window.open(url, '_blank');
            } else {
                showToast(currentLanguage === 'en' ? 
                    'Please enable location to find nearby food' : 
                    'কাছাকাছি খাবার খুঁজতে অবস্থান সক্রিয় করুন');
            }
        }

        // Weather Functions
        function showWeatherInfo() {
            const weatherOverlay = document.createElement('div');
            weatherOverlay.className = 'side-menu-overlay active';
            weatherOverlay.id = 'weatherOverlay';
            weatherOverlay.onclick = closeWeatherWidget;
            document.body.appendChild(weatherOverlay);

            const weatherWidget = document.createElement('div');
            weatherWidget.className = 'weather-widget';
            weatherWidget.id = 'weatherWidget';
            
            weatherWidget.innerHTML = `
                <button class="weather-close" onclick="closeWeatherWidget()">&times;</button>
                <h3 style="margin-bottom: 1rem; text-align: center; color: var(--primary-color);">
                    ${currentLanguage === 'en' ? 'Weather Forecast for Kolkata' : 'কলকাতার আবহাওয়ার পূর্বাভাস'}
                </h3>
                
                <div class="weather-current">
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">${weatherData.current.icon}</div>
                    <div class="weather-temp">${weatherData.current.temp}°C</div>
                    <div class="weather-desc">${weatherData.current.condition[currentLanguage]}</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        ${currentLanguage === 'en' ? 'Feels like' : 'অনুভূত হচ্ছে'} ${weatherData.current.feelsLike}°C
                    </div>
                    
                    <div class="weather-details">
                        <div>💧 ${currentLanguage === 'en' ? 'Humidity:' : 'আর্দ্রতা:'} ${weatherData.current.humidity}%</div>
                        <div>💨 ${currentLanguage === 'en' ? 'Wind:' : 'বাতাস:'} ${weatherData.current.windSpeed} km/h</div>
                        <div>👁️ ${currentLanguage === 'en' ? 'Visibility:' : 'দৃশ্যমানতা:'} ${weatherData.current.visibility} km</div>
                        <div>☀️ ${currentLanguage === 'en' ? 'UV Index:' : 'ইউভি সূচক:'} ${weatherData.current.uvIndex}</div>
                    </div>
                </div>
                
                <div class="weather-forecast">
                    <h4 style="margin-bottom: 1rem; color: var(--primary-color);">
                        ${currentLanguage === 'en' ? '5-Day Forecast' : '৫ দিনের পূর্বাভাস'}
                    </h4>
                    ${weatherData.forecast.map(day => `
                        <div class="forecast-day">
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div style="font-size: 1.5rem;">${day.icon}</div>
                                <div>
                                    <div style="font-weight: bold;">${day.day[currentLanguage]}</div>
                                    <div style="font-size: 0.8rem; opacity: 0.8;">${day.date}</div>
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 0.9rem; margin-bottom: 2px;">${day.condition[currentLanguage]}</div>
                                <div style="font-weight: bold;">${day.high}° / ${day.low}°</div>
                                <div style="font-size: 0.8rem; color: #007bff;">🌧️ ${day.rain}%</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.body.appendChild(weatherWidget);
            toggleSideMenu();
        }

        function closeWeatherWidget() {
            const weatherWidget = document.getElementById('weatherWidget');
            const weatherOverlay = document.getElementById('weatherOverlay');
            
            if (weatherWidget) document.body.removeChild(weatherWidget);
            if (weatherOverlay) document.body.removeChild(weatherOverlay);
        }

        // Menu Functions
        function showBookmarks() {
            if (bookmarkedPandals.size === 0) {
                const message = currentLanguage === 'en' ? 
                    'No bookmarked pandals yet! Start exploring and bookmark your favorites.' :
                    'এখনো কোনো পণ্ডেল পছন্দের তালিকায় নেই! অন্বেষণ শুরু করুন এবং আপনার পছন্দের পণ্ডেলগুলি বুকমার্ক করুন।';
                showToast(message, 'info');
                return;
            }
            
            showSection('pandals');
            toggleSideMenu();
            
            const cards = document.querySelectorAll('.pandal-card');
            cards.forEach(card => {
                const pandalName = card.getAttribute('data-name');
                const pandal = pandals.find(p => p.name[currentLanguage].toLowerCase() === pandalName);
                card.style.display = bookmarkedPandals.has(pandal.id) ? 'block' : 'none';
            });
        }

        function showMyRoute() {
            showSection('map');
            toggleSideMenu();
        }

        function showAR() {
            toggleSideMenu();
            showModal('arModal');
        }

        function showThemeArchive() {
            toggleSideMenu();
            showModal('themeArchiveModal');
        }

        function showSelfieWall() {
            toggleSideMenu();
            showModal('selfieModal');
        }

        function showBadges() {
            toggleSideMenu();
            showModal('badgesModal');
        }

        function clearAllData() {
            if (confirm(currentLanguage === 'en' ? 
                'Are you sure you want to clear all data? This cannot be undone.' :
                'আপনি কি নিশ্চিত যে সমস্ত ডেটা মুছে ফেলতে চান? এটি পূর্বাবস্থায় ফেরানো যাবে না।')) {
                
                bookmarkedPandals.clear();
                visitedPandals.clear();
                routeProgress = 0;
                
                localStorage.removeItem('pujaAppData');
                
                loadPandals();
                updateProgress();
                toggleSideMenu();
                
                showToast(currentLanguage === 'en' ? 'All data cleared!' : 'সমস্ত ডেটা মুছে ফেলা হয়েছে!');
            }
        }

        function shareApp() {
            const shareText = currentLanguage === 'en' ? 
                'Check out the Kolkata Durga Puja Guide 2025! Find all pandals, routes, and cultural information in one place.' :
                'কলকাতা দুর্গাপূজা গাইড ২০২৫ দেখুন! সব পণ্ডেল, রুট এবং সাংস্কৃতিক তথ্য এক জায়গায় পান।';
            
            if (navigator.share) {
                navigator.share({
                    title: currentLanguage === 'en' ? 'Kolkata Durga Puja Guide 2025' : 'কলকাতা দুর্গাপূজা গাইড ২০২৫',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText + '\n' + window.location.href).then(() => {
                    showToast(currentLanguage === 'en' ? 'App details copied to clipboard!' : 'অ্যাপের বিবরণ ক্লিপবোর্ডে কপি করা হয়েছে!');
                });
            }
            toggleSideMenu();
        }

        // Modal Functions
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
            }
        }

        // AR Functions
        function startARCamera() {
            showToast(currentLanguage === 'en' ? 
                'AR Camera simulation active! Point around to see nearby pandals.' : 
                'এআর ক্যামেরা সিমুলেশন সক্রিয়! কাছাকাছি পণ্ডেল দেখতে চারপাশে নির্দেশ করুন।');
        }

        // Photo Functions
        function capturePhoto() {
            showToast(currentLanguage === 'en' ? 
                'Camera feature would open here in a real app' : 
                'প্রকৃত অ্যাপে এখানে ক্যামেরা ফিচার খুলবে');
        }

        function uploadPhoto() {
            const file = document.getElementById('photoUpload').files[0];
            if (file) {
                showToast(currentLanguage === 'en' ? 
                    'Photo uploaded to selfie wall!' : 
                    'সেলফি ওয়ালে ছবি আপলোড করা হয়েছে!');
                saveData();
            }
        }

        // Emergency Functions
        function triggerSOS() {
            if (confirm(currentLanguage === 'en' ? 
                'This will share your location and send an emergency alert. Continue?' :
                'এটি আপনার অবস্থান শেয়ার করবে এবং একটি জরুরি সতর্কতা পাঠাবে। চালিয়ে যেতে চান?')) {
                
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition((position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        const message = currentLanguage === 'en' ? 
                            `EMERGENCY ALERT from Durga Puja Guide App\nLocation: ${lat}, ${lng}\nTime: ${new Date().toLocaleString()}\nUser needs assistance!` :
                            `দুর্গাপূজা গাইড অ্যাপ থেকে জরুরি সতর্কতা\nঅবস্থান: ${lat}, ${lng}\nসময়: ${new Date().toLocaleString()}\nব্যবহারকারীর সাহায্য প্রয়োজন!`;
                        
                        navigator.clipboard.writeText(message);
                        showToast(currentLanguage === 'en' ? 'Emergency alert prepared! Call 100 for police.' : 'জরুরি সতর্কতা প্রস্তুত! পুলিশের জন্য ১০০ কল করুন।', 'error');
                        
                        showSection('emergency');
                    });
                } else {
                    showToast(currentLanguage === 'en' ? 'Location not available. Call 100 directly.' : 'অবস্থান পাওয়া যাচ্ছে না। সরাসরি ১০০ কল করুন।', 'error');
                }
            }
        }

        // Time and Date Functions
        function updateDateTime() {
            const now = new Date();
            const options = { 
                timeZone: 'Asia/Kolkata',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            
            // Update any time displays if they exist
            const timeElements = document.querySelectorAll('.current-time');
            timeElements.forEach(el => {
                el.textContent = now.toLocaleTimeString('en-IN', {
                    timeZone: 'Asia/Kolkata',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            });
        }

        // Utility Functions
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            
            let bgColor = 'linear-gradient(135deg, #28a745, #20c997)';
            if (type === 'error') bgColor = 'linear-gradient(135deg, #dc3545, #c82333)';
            if (type === 'warning') bgColor = 'linear-gradient(135deg, #ffc107, #e0a800)';
            if (type === 'info') bgColor = 'linear-gradient(135deg, #17a2b8, #138496)';
            
            toast.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 9999;
                max-width: 300px;
                font-size: 0.9rem;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(toast)) {
                        document.body.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        function createConfetti() {
            const colors = ['#ff6b35', '#f7931e', '#8B0000', '#DC143C', '#ffd700'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.style.cssText = `
                    position: fixed;
                    width: 10px;
                    height: 10px;
                    background: ${colors[Math.floor(Math.random() * colors.length)]};
                    top: -10px;
                    left: ${Math.random() * window.innerWidth}px;
                    z-index: 9999;
                    border-radius: 50%;
                    pointer-events: none;
                `;
                
                document.body.appendChild(confetti);
                
                const animation = confetti.animate([
                    { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                    { transform: `translateY(${window.innerHeight + 20}px) rotate(720deg)`, opacity: 0 }
                ], {
                    duration: 3000 + Math.random() * 2000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                animation.onfinish = () => {
                    if (document.body.contains(confetti)) {
                        document.body.removeChild(confetti);
                    }
                };
            }
        }

        // Data Management
        function saveData() {
            const data = {
                bookmarkedPandals: Array.from(bookmarkedPandals),
                visitedPandals: Array.from(visitedPandals),
                routeProgress: routeProgress,
                userLocation: userLocation
            };
            localStorage.setItem('pujaAppData', JSON.stringify(data));
        }

        function loadSavedData() {
            try {
                const data = JSON.parse(localStorage.getItem('pujaAppData') || '{}');
                bookmarkedPandals = new Set(data.bookmarkedPandals || []);
                visitedPandals = new Set(data.visitedPandals || []);
                routeProgress = data.routeProgress || 0;
                userLocation = data.userLocation || null;
            } catch (e) {
                console.log('No saved data found');
            }
        }

        function saveSettings() {
            const settings = {
                language: currentLanguage,
                theme: currentTheme
            };
            localStorage.setItem('pujaAppSettings', JSON.stringify(settings));
        }

        function loadSettings() {
            try {
                const settings = JSON.parse(localStorage.getItem('pujaAppSettings') || '{}');
                
                if (settings.language) {
                    currentLanguage = settings.language;
                    document.getElementById('langText').textContent = currentLanguage === 'en' ? 'বাং' : 'ENG';
                }
                
                if (settings.theme) {
                    currentTheme = settings.theme;
                    document.body.setAttribute('data-theme', currentTheme);
                    document.getElementById('themeIcon').className = currentTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
                }
            } catch (e) {
                console.log('No settings found');
            }
        }

        // Hide preloader and initialize app
        window.addEventListener('load', function() {
            setTimeout(function() {
                document.getElementById('preloader').classList.add('hide');
            }, 5000);
            
            // Initialize app after preloader
            setTimeout(init, 5500);
        });

        // Add some additional CSS animations
        const style = document.createElement('style');
        style.textContent = `
            .toast {
                animation: slideInFromRight 0.3s ease;
            }
            
            @keyframes slideInFromRight {
                from { transform: translateX(100%); }
                to { transform: translateX(0); }
            }
            
            .pandal-card {
                transition: all 0.3s ease;
            }
            
            .pandal-card:hover {
                transform: translateY(-2px);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>